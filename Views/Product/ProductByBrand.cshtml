@using LadyFirstShop.Data.Response;
@using LadyFirstShop.Data.ViewModel;
@model PagedResult<ProductViewModel>
@{
	ViewData["Title"] = "Index";
	Layout = "~/Views/Shared/_Layout.cshtml";
	int show4 = 0;
	int show8 = 0;
	int setColorId = 0;
	int count = 0;
	int total = 0;
	int brandId = 0;
	int min = 0;
	int max = 1000000;
	@if (ViewBag.Min != null)
	{
		min = @ViewBag.Min;
	}
	@if (ViewBag.Max != null)
	{
		max = @ViewBag.Max;
	}
}
<section>
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<div class="left-sidebar">
					<div class="brands_products">
						<!--brands_products-->
						<h2>Thương hiệu</h2>
						<div class="brands-name">
							<ul class="nav nav-pills nav-stacked">
								<li><a href="/san-pham?id=0&min=@min&max=@max"><b>Tất cả</b></a></li>
								@foreach (var item in ViewBag.Brand)
								{
									<li><a href="/san-pham?id=@item.Id&min=@min&max=@max"><b>@item.Name</b></a></li>
								}
							</ul>
						</div>
					</div><!--/brands_products-->
					<div class="price-range">
					<!--price-range-->
					<h2>Lọc theo giá</h2>
					<center>
							<div class="well text-center">
								<input type="text" class="span2" value="" data-slider-min="0" data-slider-max="1000000" data-slider-step="10000" data-slider-value="[@min,@max]" id="sl2"><br />
								<div>
									<b class="pull-left">0</b>
									<b class="pull-right">1.000.000<sup>đ</sup></b>
								</div>
								<input type="hidden" value="@ViewBag.BrandId" id="branId" />

								<button style="background-color:#FE980F;margin-top: 10px; padding: 5px 80px;font-size: 15px;" id="filterProduct" class="btn btn-warning">Lọc</button>
							</div>
					</center>
					</div><!--/price-range-->

				</div>
			</div>

			<div class="col-sm-9">
				<div class="category-tab">
					<!--category-tab-->
					<div class="recommended_items">
						<!--recommended_items-->
						<h2 class="title text-center">@foreach (var item in Model.Items)
							{
								if (item.BrandName != null)
								{
									@item.BrandName
									brandId = item.BrandId;
									; break;
								}
								else
								{
									item.BrandName = "Shop";
									brandId = 0;
									@item.BrandName;
									break;
								}
							}
						</h2>

						@foreach (var product in Model.Items)
						{
							@foreach (var color in product.ProductColors)
							{
								if (color.Quantity > 0)
								{
									setColorId = color.Id;
									break;
								}
							}
							<a href="/chi-tiet-san-pham?id=@product.Id&colorId=@setColorId">
								<div class="col-sm-3">
									<div class="product-image-wrapper">
										<div class="single-products">
											<div class="productinfo text-center">
												<img src="/product-image/@product.Image" alt="" />
												@if (product.SalePrice == 0)
												{
													<h4 style="color: #a91313;">@product.Price.ToString("N0")<sup>đ</sup></h4>
												}
												else
												{
													<div class="row">
														<h5 style="color: silver; float:left; margin-left: 30px;"><del>@product.Price.ToString("N0")<sup>đ</sup></del></h5>
														<h4 style="color: #a91313; float: right; margin-right: 25px;">@product.SalePrice.ToString("N0")<sup>đ</sup></h4>
													</div>
												}
												<p class="dauBaCham">
													@product.Name
												</p>
												<div class="processBar">
													<div class="comp"></div>
													<div class="count-number">ĐÃ BÁN <span>@product.Sold</span></div>
												</div>
											</div>

										</div>
										@if (product.SalePrice > 0)
										{
											<img class="saleImg"   src="/public/images/home/sale.png" class="new" alt="">
										}
									</div>
								</div>
							</a>
						}
					</div><!--/recommended_items-->
				</div><!--/category-tab-->
				@if(Model.PageCount > 1)
				{
					<ul class="pagination">
						@for(int i = 1; i<= Model.PageCount; i++)
						{
							if(Model.PageIndex == i)
							{

								<li class="active"><a href="">@i</a></li>
							}
							else
							{
								<li><a href="/san-pham?id=@brandId&pageIndex=@i&keyword=@ViewBag.Keyword&min=@min&max=@max">@i</a></li>
							}
						}
						@{
							int nextPage = 0;
							if(Model.PageIndex +1 <= Model.PageCount)
							{
								nextPage = Model.PageIndex + 1;
							}
							else
							{
								nextPage = Model.PageIndex;
							}
						}
						<li><a href="/san-pham?id=@brandId&pageIndex=@nextPage&keyword=@ViewBag.Keyword&min=@min&max=@max">&raquo;</a></li>
					</ul>
				}


			</div>
		</div>
	</div>
</section>